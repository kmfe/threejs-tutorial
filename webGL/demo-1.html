<!doctype html>
<html lang='en'>
<head>
  <meta charset='UTF-8'>
  <meta name='viewport'
          content='width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0'>
  <meta http-equiv='X-UA-Compatible' content='ie=edge'>
  <title>动态绘制点</title>
</head>
<body>
<div id='canvas'></div>
<div class='tips'>点击屏幕试一试</div>
<script type='shader-source' id='vertexShader'>
  void main (){
    // 申明顶点位置
    gl_Position = vec4(0.0, 0.0, 0.0, 1.0)

    // 申明绘制点的大小
    gl_PointSize = 10.0
  }
</script>

<script type='shader-source' id='fragmentShader'>
  void main (){
    gl_FragColor = vec4(1.0, 0.0, 0.0, 1.0)
  }
</script>

<script>
  const canvas = document.querySelector('#canvas')
  const gl = canvas.getContext('webgl')  || canvas.getContext("experimental-webgl");

  // 顶点着色器处理
  // 获取顶点着色器源码
  const vertexShaderSource = document.querySelector('#vertexShader').innerHTML

  // 创建顶点着色器对象
  const vertexShader = gl.createShader(gl.VERTEX_SHADER)

  // 将源码分配给顶点着色器对象
  gl.shaderSource(vertexShader, vertexShaderSource)

  // 编译顶点着色器程序
  gl.compileShader(vertexShader)

  // 片源着色器
  const fragmentShaderSource = document.querySelector('#fragmentShader').innerHTML
  const fragmentShader = gl.createShader(gl.FRAGMENT_SHADER)
  gl.shaderSource(fragmentShader, fragmentShaderSource)
  gl.compileShader(fragmentShader)

  // 着色器程序
  const program = gl.createProgram()
  // 将顶点着色器挂载在着色器程序上
  gl.attachShader(program, vertexShader)

  // 将片源着色器挂载在着色器程序上
  gl.attachShader(program, fragmentShader)

  // 链接着色器程序
  gl.linkProgram(program)
</script>
</body>
</html>
